<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <meta http-equiv="X-UA-Compatible" content="ie=edge" />

    <link
      rel="stylesheet"
      href="https://stackpath.bootstrapcdn.com/bootstrap/4.3.1/css/bootstrap.min.css"
    />
    <link
      rel="stylesheet"
      href="https://stackpath.bootstrapcdn.com/font-awesome/4.7.0/css/font-awesome.min.css"
    />
    <title>Weather Dashboard</title>
  </head>

  <body>
    <header class="container-fluid text-center text-white bg-dark p-2">
      <h1>Weather Dashboard</h1>
    </header>

    <div class="container-fluid">
      <div class="row">
        <aside class="col-lg-3 bg-light">
          <h5 class="mt-1">Search for a City:</h5>
          <div class="form-inline form-group">
            <input class="form-control" type="text" id="search-value" />
            <button class="btn btn-primary" id="search-button">
              <i class="fa fa-search"></i>
            </button>
          </div>

          <ul class="list-group history" id="history"></ul>
        </aside>

        <div class="col-lg-9">
          <div id="today" class="mt-3">
            <h2><span id="city"></span> <span id ="currentDay"></span><img id="weather_image" src=""></h2>
          </div>
          <div class="mt-3">
            <span id="temperature"></span>
          </div>
          <div class="mt-3">
            <span id="humidity"></span>
          </div>
          <div class="mt-3">
            <span id="wind"></span>
          </div>
          <div id="forecast" class="row mt-3"></div>
        </div>
      </div>
    </div>
 
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.2.1/jquery.min.js"></script>
    <script src="https://unpkg.com/dayjs@1.8.21/dayjs.min.js"></script>
    <!-- <script src="script.js"></script> -->
    <script>
    var APIKey = "166a433c57516f51dfab1f7edaed8413";
    // const search = document.getElementById("search-button");
    // const input = document.getElementById("search-value");
    
    // search.addEventListener("click", function(){
    //   var weather ="api.openweathermap.org/data/2.5/weather?q=" + input.value + "&appid=" + APIKey;
    //   console.log(weather);
    //   });
    const today = document.getElementById("currentDay");
    const now = dayjs().format('(M/DD/YYYY)'); 

    $( document ).ready(function() {
  
      $("#search-button").click(function(){  

          var query_param = $(this).prev().val();

          if ($(this).prev().attr("id") == "search-value") {
              var weather = "https://api.openweathermap.org/data/2.5/weather?q=" + query_param + "&units=imperial" + "&APPID=" + APIKey;
          } 
          $.getJSON(weather,function(json){
              $("#city").html(json.name); today.append(now);
              $("#weather_image").attr("src", "https://openweathermap.org/img/w/" + json.weather[0].icon + ".png");
              $("#temperature").html("Temperature: " + json.main.temp + " Â°F"); //shift + option + 8 to get degree symbol on a Mac
              $("#humidity").html("Humidity: " + json.main.humidity + "%");
              $("#wind").html("Wind Speed: " + json.wind.speed + " MPH");
          });
      })
    });
    </script>
  </body>
</html>
